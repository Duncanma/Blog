<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.54.0" />

    
    
    

<title> â€¢ Duncan Mackenzie</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="I answer quite a few questions on the forums on GotDotNet{.broken_link}, and sometimes those answers are interesting enough (in my opinion) to be exposed to a larger audience&#8230;. Coding this particular one{.broken_link} caused Brian Johnson{.broken_link} to say&#8230; &#8220;cool&#8221;, so it seems worth posting about here ðŸ™‚
The question was (paraphrased) &#8220;How do I stop AutoRun from happening while my app is running and the user puts in a CD?&#8221;, and the answer is that if your app is the active application, then you can listen for and respond to a certain Windows Message (QueryCancelAutoPlay) and choose to cancel the AutoRun/AutoPlay action for that particular moment (the next CD inserted will result in the message being sent again, and your code gets to choose once again whether or not to cancel the event)."/>

<meta property="og:title" content="" />
<meta property="og:description" content="I answer quite a few questions on the forums on GotDotNet{.broken_link}, and sometimes those answers are interesting enough (in my opinion) to be exposed to a larger audience&#8230;. Coding this particular one{.broken_link} caused Brian Johnson{.broken_link} to say&#8230; &#8220;cool&#8221;, so it seems worth posting about here ðŸ™‚
The question was (paraphrased) &#8220;How do I stop AutoRun from happening while my app is running and the user puts in a CD?&#8221;, and the answer is that if your app is the active application, then you can listen for and respond to a certain Windows Message (QueryCancelAutoPlay) and choose to cancel the AutoRun/AutoPlay action for that particular moment (the next CD inserted will result in the message being sent again, and your code gets to choose once again whether or not to cancel the event)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://duncanmackenzie.net/posts/2004-05-13-enablingdisabling-autorun-from-your-net-application/" />



    






<link rel="stylesheet" href="/scss/hyde-hyde.9181f25ed2263aeb878ec6f8a84f10c4ebb16150000fca8767308880bdde5ca0.css" integrity="sha256-kYHyXtImOuuHjsb4qE8QxOuxYVAAD8qHZzCIgL3eXKA=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://duncanmackenzie.net/">Duncan Mackenzie</a>
      </span>
      
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Duncan Mackenzie</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		
		</li>
	</ul>
</div>

        <section class="social">
	
	
	
	
	
	
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    


  </div>
</div>

        <div class="content container">
            
    <article>
  <header>
    <h1></h1>
    
    
<div class="post__meta">
    
    
    
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 1 min read
</div>


  </header>
  
  
  <div class="post">
    <p>I answer quite a few questions on the forums on <a href="http://www.gotdotnet.com/">GotDotNet</a>{.broken_link}, and sometimes those answers are interesting enough (in my opinion) to be exposed to a larger audience&#8230;. Coding <a href="http://www.gotdotnet.com/Community/MessageBoard/Thread.aspx?id=220170&amp;Page=1#222216">this particular one</a>{.broken_link} caused <a href="http://blogs.msdn.com/brianjo">Brian Johnson</a>{.broken_link} to say&#8230; &#8220;cool&#8221;, so it seems worth posting about here ðŸ™‚</p>

<p>The question was (paraphrased) &#8220;How do I stop AutoRun from happening while my app is running and the user puts in a CD?&#8221;, and the answer is that if your app is the active application, then you can listen for and respond to a certain Windows Message (QueryCancelAutoPlay) and choose to cancel the AutoRun/AutoPlay action for that particular moment (the next CD inserted will result in the message being sent again, and your code gets to choose once again whether or not to cancel the event). Only one Win32 API call is required, RegisterWindowMessage, and overall it is pretty simple code. <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/programmersguide/shell_basics/shell_basics_extending/autorun/autoplay_reg.asp">More details on the underlying functionality is available on MSDN</a>.</p>

<p>Not complicated, but neat enough&#8230;. and definitely something I&#8217;m going to add to my musicxp system.</p>

<p>Demo app with source available <a href="http://www.duncanmackenzie.net/Samples/default.aspx">on my personal site</a>{.broken_link}</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/posts/2004-05-14-eric-posts-the-c-teams-schedule-for-teched-2004/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle"></span>
    </a>
    
    
    <a href="/posts/2004-05-13-duncans-vs-net-2003-wouldnt-run-and-why-that-is-good-for-you/" class="navigation-next">
      <span class="navigation-tittle"></span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    
<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    
    
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    




    



    </body>
</html>
