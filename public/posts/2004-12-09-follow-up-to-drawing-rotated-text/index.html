<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.54.0" />

    
    
    

<title> â€¢ Duncan Mackenzie</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="The same programmer who ask for an example of rotated text is back with another interesting request; how to partially fill a circle from the bottom up&#8230;
as if it was a glass that you&#8217;ve poured water into&#8230; so here goes (this is only a snippet of the code, see the original post for the rest);
Protected Overrides Sub OnPaint( _ ByVal e As System.Windows.Forms.PaintEventArgs) e.Graphics.Clear(Me.BackColor) Dim bounds As Rectangle Dim g As Graphics Dim rotation As Single = 0 g = e."/>

<meta property="og:title" content="" />
<meta property="og:description" content="The same programmer who ask for an example of rotated text is back with another interesting request; how to partially fill a circle from the bottom up&#8230;
as if it was a glass that you&#8217;ve poured water into&#8230; so here goes (this is only a snippet of the code, see the original post for the rest);
Protected Overrides Sub OnPaint( _ ByVal e As System.Windows.Forms.PaintEventArgs) e.Graphics.Clear(Me.BackColor) Dim bounds As Rectangle Dim g As Graphics Dim rotation As Single = 0 g = e." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://duncanmackenzie.net/posts/2004-12-09-follow-up-to-drawing-rotated-text/" />



    






<link rel="stylesheet" href="/scss/hyde-hyde.9181f25ed2263aeb878ec6f8a84f10c4ebb16150000fca8767308880bdde5ca0.css" integrity="sha256-kYHyXtImOuuHjsb4qE8QxOuxYVAAD8qHZzCIgL3eXKA=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://duncanmackenzie.net/">Duncan Mackenzie</a>
      </span>
      
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Duncan Mackenzie</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		
		</li>
	</ul>
</div>

        <section class="social">
	
	
	
	
	
	
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    


  </div>
</div>

        <div class="content container">
            
    <article>
  <header>
    <h1></h1>
    
    
<div class="post__meta">
    
    
    
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 1 min read
</div>


  </header>
  
  
  <div class="post">
    <p>The same programmer who ask for <a href="http://blogs.duncanmackenzie.net/duncanma/archive/2004/12/02/913.aspx" target="_blank" class="broken_link">an example of rotated text</a> is back with another interesting request; how to partially fill a circle from the bottom up&#8230;</p>

<p><img src="http://msdn.microsoft.com/vbasic/art/compass_filled.png" alt="" /></p>

<p>as if it was a glass that you&#8217;ve poured water into&#8230; so here goes (this is only a snippet of the code, see <a href="http://blogs.duncanmackenzie.net/duncanma/archive/2004/12/02/913.aspx" target="_blank" class="broken_link">the original post </a>for the rest);</p>

<pre><font color="Blue" family="Microsoft Sans Serif">Protected</font> <font color="Blue" family="Microsoft Sans Serif">Overrides</font> <font color="Blue" family="Microsoft Sans Serif">Sub</font> OnPaint( _
            <font color="Blue" family="Microsoft Sans Serif">ByVal</font> e <font color="Blue" family="Microsoft Sans Serif">As</font> System.Windows.Forms.PaintEventArgs)
        e.Graphics.<font color="Blue" family="Microsoft Sans Serif">Clear</font>(<font color="Blue" family="Microsoft Sans Serif">Me</font>.BackColor)
        <font color="Blue" family="Microsoft Sans Serif">Dim</font> bounds <font color="Blue" family="Microsoft Sans Serif">As</font> Rectangle
        <font color="Blue" family="Microsoft Sans Serif">Dim</font> g <font color="Blue" family="Microsoft Sans Serif">As</font> Graphics
        <font color="Blue" family="Microsoft Sans Serif">Dim</font> rotation <font color="Blue" family="Microsoft Sans Serif">As</font> <font color="Blue" family="Microsoft Sans Serif">Single</font> = 0
        g = e.Graphics
        bounds = <font color="Blue" family="Microsoft Sans Serif">New</font> Rectangle(50, 50, _
            <font color="Blue" family="Microsoft Sans Serif">Me</font>.Width - 100, <font color="Blue" family="Microsoft Sans Serif">Me</font>.Height - 100)
        <font color="Blue" family="Microsoft Sans Serif">Dim</font> percentageToFill <font color="Blue" family="Microsoft Sans Serif">As</font> <font color="Blue" family="Microsoft Sans Serif">Single</font> = 0.75
        <font color="Blue" family="Microsoft Sans Serif">Dim</font> fillArea <font color="Blue" family="Microsoft Sans Serif">As</font> <font color="Blue" family="Microsoft Sans Serif">New</font> Rectangle( _
            50, 50 + ((<font color="Blue" family="Microsoft Sans Serif">Me</font>.Height - 100) * (1 - percentageToFill)), _
            <font color="Blue" family="Microsoft Sans Serif">Me</font>.Width - 100, ((<font color="Blue" family="Microsoft Sans Serif">Me</font>.Height - 100) * percentageToFill))
        <font color="Blue" family="Microsoft Sans Serif">Dim</font> oldClip <font color="Blue" family="Microsoft Sans Serif">As</font> Region = g.Clip
        g.SetClip(fillArea)
        g.FillEllipse(Brushes.Red, bounds)
        g.Clip = oldClip
        g.DrawEllipse(Pens.Black, bounds)


</pre>

<p>There is probably more than one way to do this, but my code just fills the whole circle, but sets the clip region first so that it only draws within the bounds of a certain rectangle&#8230;</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/posts/2004-12-13-enter-instead-of-tab/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle"></span>
    </a>
    
    
    <a href="/posts/2004-12-09-datagrid-programming/" class="navigation-next">
      <span class="navigation-tittle"></span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    
<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    
    
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    




    



    </body>
</html>
